<head>
  <title>登录</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <script type="text/javascript" src="./js/jquery-1.8.0.min.js"></script>
  <script type="text/javascript" src="./handle/login/login.js"></script>
  <link href="./css/login2.css" rel="stylesheet" type="text/css" />
</head>
<html>
<div class="page-container" id="MainView"></div>
<script type = "text/template" id="mainView-template">

<h1>中国船舶工业集团安全生产技术研究中心</h1>
<div class="login" style="margin-top:50px; ">
  <div class="header" >
    <div class="hd">
      <label class="hd-top">
       欢迎登陆！</label>
    </div>
  </div>
  <div class="web_qr_login" id="web_qr_login" >
    <!--登录-->
    <div class="web_login" id="web_login">
      <div class="login-box">
        <div class="login_form">
          <form action="#" class="loginForm"  id = "validate-data" >
            <div class="uinArea" id="uinArea">
              <label class="input-tips" for="user-name">用户名：</label>
              <div class="inputOuter" id="uArea">
                <input type="text" id="user-name" name="username" class="inputstyle"/>
              </div>
            </div>
            <div class="pwdArea" id="pwdArea">
              <label class="input-tips" for="pass-word">密&nbsp&nbsp&nbsp码：</label>
              <div class="inputOuter" id="pArea">
                <input type="password" id="pass-word"name="password" class="inputstyle"/>
              </div>
              <div>
              自动登录：<input type="checkbox" name="rememberMe" value="true" style="margin-left: 10px;"/>
              </div>
              </div>
            <div class="b-button">
              <input type="submit" value="登 录" class="button_blue" id = "js_login"/>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!--登录end-->
  </div>
</div>
</script>
</body>
<!-- Javascript -->
<script src="./js/jquery-1.8.0.min.js" ></script>
<script type="text/javascript" src="./js/jquery.validate.min.js"></script>
<script type="text/javascript" src="./js/jquery.json.js"></script>
<script type="text/javascript" src="./js/Underscore.js"></script>
<script type="text/javascript" src="./js/Backbone.js"></script>
<script type="text/javascript" src="./js/backbone.layoutmanager.js"></script>
<script type="text/javascript" src="entities/entities.js"></script>
<script src="./js/supersized.3.2.7.min.js" ></script>
<script src="./js/supersized-init.js" ></script>
<script src="./js/scripts.js" ></script>
<script type="text/javascript" src="handle/login/login.js"></script>

</html>
<script type="text/javascript">
  (function(Backbone, _){
    var UserLoginModel = new Entities.Login.Model();
    var Url = Entities.config.apiUrl;
    Backbone.Layout.configure({
      manage: true
    });
    var MainView = Backbone.View.extend({
      template:"#mainView-template",
      events:{
        "click #js_login":'_onValidator',
      },
      /*验证表单*/
      _onValidator:function(){
        var parent=this;
        $('#validate-data').validate({
          rules:{
            username:'required',
            password:'required'
          },
          messages:{
            username:'请输入用户名',
            password:'请输入密码'
          },
          submitHandler:function() {
            parent._onSubmit();
          }
        });
      },
      _onSubmit:function() {
        var form_data =this.$('form').serialize();
        UserLoginModel.login(form_data).then(function(res){
          if(res.status==0||res.error==null){
            window.location.href=Url+"/front/view/index.html";
          }
          else{
            return false;
          }
        });
      }
    });
    new MainView({el:'#MainView'}).render();
  })(Backbone,_);
</script>