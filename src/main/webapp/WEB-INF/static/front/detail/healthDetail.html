<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>安全职业健康知识管理</title>
		<link rel="shortcut icon" href="../images/logo.png" />
		<link type="text/css" href="../css/bootstrap.min.css" rel="stylesheet" />
		<link type="text/css" href="../css/main.css" rel="stylesheet" />
	</head>

	<body>
		<div class="container" id="MainView"></div>
		<script type="text/template" id="MainView-template">
			<div class='row header'>
				<div class='col-md-12'>
					<div class='row title'>
						<div class='col-md-6 col-md-push-3'>
							<h3>中国船舶工业集团安全生产技术研究中心</h3>
							<p>SAFETY PRODUCTION TECHNOLOGY RESEARCH CENTER,CSSC</p>
						</div>
					</div>
					<div class='row'>
						<div class='col-md-11 col-md-push-1'>
							<nav class="navbar navbar-default" role="navigation">
								<div class="container-fluid">
									<div class="navbar-header">
										<a class="navbar-brand" href="../view/index.html">网站首页</a>
									</div>
									<div>
										<ul class="nav navbar-nav">
											<li class="active">
												<a href="../view/standard.html">标准管理</a>
											</li>
											<li>
												<a href="../view/law.html">法律法规管理</a>
											</li>
											<li>
												<a href="../view/health.html">安全及职业健康知识管理</a>
											</li>
											<li>
												<a href="../view/frock.html">安全工装管理</a>
											</li>
											<li>
												<a href="../view/accident.html">案例分析管理</a>
											</li>
											<li>
												<a href="../view/technique.html">国内外新技术管理</a>
											</li>
											<li>
												<a href="#">联系我们</a>
											</li>
										</ul>
									</div>
								</div>
							</nav>
						</div>
					</div>
				</div>
			</div>
			<div class="row content ">
				<img src="../images/image2.JPG" width="1170" height="270" />
			</div>
			<div class="row content">
				<div class="col-xs-3">
					<div class="Content-search">
						<h4 class="list-group-item active">站内搜索</h4>
						<form class="form-horizontal">
							<select class="form-control" name="condition">
								<option value="name">标题</option>
								<option value="category">所属类别</option>
								<option value="keywords">关键词</option>
							</select>
							<div class="form-group" style="margin-top: 10px;">
								<div class="col-xs-8">
									<input class="form-control" type="text" placeholder="请输入查询条件" />
								</div>
								<div class="col-xs-4">
									<button type="button" class="btn btn-info js-search">搜素</button>
								</div>
							</div>
						</form>
					</div>
					<div class="Menu-item">
						<h4 class="list-group-item active">标准</h4>
						<ul class="list-group">
							<li class="list-group-item">
								<a href="javascript:void(0);" class="js-work" title="作业健康知识">
									作业健康知识
								</a>
							</li>
							<li class="list-group-item">
								<a href="javascript:void(0);" class="js-pro" title="职业健康知识">
									职业健康知识
								</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-xs-9">
					<div class="row">
						<div class="col-xs-3">
							<h4>安全职业健康知识管理</h4>
						</div>
						<div class=" pull-right" style="padding-top:10px;">
							网站首页 > 安全职业健康知识管理
						</div>
					</div>
					<div class="row" id="healthDetailView">

					</div>
				</div>
			</div>
			</div>
		</script>

		<!--安全职业健康知识详情视图-->
		<script type="text/template" id="healthDetailView-template">
			<div class='head'>
				<h3 class="text-center"> <%= name %> </h3>
			</div>
			<div class="text-center">
				<span>发表人:<%= publisher %></span>
				<span>发表时间:<%= this.Timer(publishDate) %></span>
			</div>

			<div class='content'>
				<div class="col-xs-10 col-xs-offset-2">
					<%= content %>
				</div>

			</div>
		</script>
	</body>
	<script src="../js/jquery-1.9.1.min.js" type="text/javascript"></script>
	<script src="../js/moment.js" type="text/javascript"></script>
	<script src="../js/jquery.json.js" type="text/javascript"></script>
	<script src="../js/Underscore.js" type="text/javascript"></script>
	<script src="../js/Backbone.js" type="text/javascript"></script>
	<script src="../js/backbone.layoutmanager.js" type="text/javascript"></script>
	<script src="../js/moment.js" type="text/javascript"></script>
	<script type="text/javascript" src="../entities/entities.js"></script>
	<script type="text/javascript" src="../handle/health/health.js"></script>
	<script type="text/javascript">
		(function(Backbone, _) {
			var EventBus = _.extend({}, Backbone.Events);
			var HealthModel = Entities.Health.Model;
			var HealthCollection = Entities.Health.Collection;
			Backbone.Layout.configure({
				manage: true
			});
			//安全职业健康知识管理视图
			var HealthDetailView = Backbone.View.extend({
				template: '#healthDetailView-template',
				initialize: function() {
					this.listenTo(this.model, 'change', this.render);
					this.onCreate();
				},
				Timer: function(time) {
					return moment(time).format('YYYY-MM-DD');
				},
				onCreate: function() {
					this.model.fetch({
						id: this.model.id
					}).then(function() {
						document.title = this.model.get('name');
					}.bind(this));

				}
			});
			var MainView = Backbone.View.extend({
				template: '#MainView-template',
				events: {
					'click .js-search': '_onShowInfo',
					'click .list-group-item a': '_onShowLaw',
				},
				initialize: function() {
					this.getParam();
				},
				getParam: function() {
					var reg = new RegExp("(^|&)" + 'id' + "=([^&]*)(&|$)");
					var r = window.location.search.substr(1).match(reg);
					if(r != null) this.m_id = +unescape(r[2]);
					return null;
				},
				afterRender: function() {
					this.healthDetailView = new HealthDetailView({
						model: new HealthModel({
							id: this.m_id
						})
					});
					this.setView('#healthDetailView', this.healthDetailView);
				}
			});
			new MainView({
				el: '#MainView'
			}).render();
		})(Backbone, _);
	</script>

</html>